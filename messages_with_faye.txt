Threaded discussions, with the ability to mark branches as new entry points/discussion heads.

Also ability to spawn propositions/motions from these

messages and motions

posting a message should insert it in place.. 

push messages in a discussion, how to insert the message into the tree as client.
messages_controller
  def create
    
  end


Class Message < ActiveRecord::Base
  acts as ancestry
    #gives parent, children more: https://github.com/stefankroes/ancestry
  alias :children :relies
  has_many :ratings
  belongs_to :author, class_name: 'User'

# needle for the thread. how you pickup a thread
Discussion < ActiveRecord::Base
  attribtes: title
  belongs_to message
  belongs_to group

Rating
  belongs_to :message
  belongs_to :author, class_name: 'User'
  attrs: useful:boolean, null: false, default:true

messages/create.js.html
  parent_node = $(".message##{message.parent_id}")
  parent_node.append("escape_javascript render(@message)");
  parent_node.find('reply_form').reset();

  <% publish_to "/messages/new" do %>
    $("#chat").append("<%= j render(@message) %>");
    $("#new_message")[0].reset();
  <% end %>
  
message/_message.html.haml partial
  # use messsage db id as div id, for javascipt to do live updates
  .message#message.id{data: {'message_id': message.id}
    %h2=message.author.name
    =message.body
    # could also include unique anchor
    %a.reply
    .reply_form

    .replies
      =render message.children

$('a.reply).click # insert reply form, and update hidden input parent_id
  clone = $('#reply_form').clone
  clone.find('input.parent_id').attr('value') = $(this).message_id
  $(this).sibling('.reply_form').insert $('message_form')
  




  

